
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2014-04-01
 Rendered using Reflow Maven Skin 1.1.0 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Bulk CSV Data Loading | Apache Phoenix</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/bootswatch/2.3.2/united/bootstrap.min.css" rel="stylesheet" />
		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/bootswatch.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/default.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->



	</head>

	<body class="page-bulk_dataload project-phoenix-site" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html"><div class="xtoplogo"></div></a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="index.html" title="Overview">Overview</a></li>
									<li ><a href="recent.html" title="New Features">New Features</a></li>
									<li ><a href="roadmap.html" title="Roadmap">Roadmap</a></li>
									<li ><a href="performance.html" title="Performance">Performance</a></li>
									<li ><a href="team.html" title="Team">Team</a></li>
									<li ><a href="mailing_list.html" title="Mailing Lists">Mailing Lists</a></li>
									<li ><a href="source.html" title="Source Repository">Source Repository</a></li>
									<li ><a href="issues.html" title="Issue Tracking">Issue Tracking</a></li>
									<li ><a href="download.html" title="Download">Download</a></li>
									<li ><a href="http://www.apache.org/licenses/" title="License" class="externalLink">License</a></li>
									<li ><a href="http://www.apache.org/foundation/sponsorship.html" title="Sponsorship" class="externalLink">Sponsorship</a></li>
									<li ><a href="http://www.apache.org/foundation/thanks.html" title="Thanks" class="externalLink">Thanks</a></li>
									<li ><a href="http://www.apache.org/security/" title="Security" class="externalLink">Security</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Using <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="faq.html" title="F.A.Q.">F.A.Q.</a></li>
									<li ><a href="Phoenix-in-15-minutes-or-less.html" title="Quick Start">Quick Start</a></li>
									<li ><a href="building.html" title="Building">Building</a></li>
									<li ><a href="tuning.html" title="Tuning">Tuning</a></li>
									<li ><a href="upgrade_from_2_2.html" title="Upgrade from 2.2">Upgrade from 2.2</a></li>
									<li ><a href="secondary_indexing.html" title="Secondary Indexes">Secondary Indexes</a></li>
									<li ><a href="joins.html" title="Joins">Joins</a></li>
									<li ><a href="views.html" title="Views">Views</a></li>
									<li ><a href="multi-tenancy.html" title="Multi tenancy">Multi tenancy</a></li>
									<li ><a href="sequences.html" title="Sequences">Sequences</a></li>
									<li ><a href="array_type.html" title="ARRAY type">ARRAY type</a></li>
									<li ><a href="salted.html" title="Salted Tables">Salted Tables</a></li>
									<li ><a href="paged.html" title="Paged Queries">Paged Queries</a></li>
									<li ><a href="dynamic_columns.html" title="Dynamic Columns">Dynamic Columns</a></li>
									<li ><a href="skip_scan.html" title="Skip Scan">Skip Scan</a></li>
									<li class="active"><a href="" title="Bulk Loading">Bulk Loading</a></li>
									<li ><a href="phoenix_on_emr.html" title="Amazon EMR Support">Amazon EMR Support</a></li>
									<li ><a href="flume.html" title="Apache Flume Plugin">Apache Flume Plugin</a></li>
									<li ><a href="pig_integration.html" title="Apache Pig Integration">Apache Pig Integration</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="language/index.html" title="Grammar">Grammar</a></li>
									<li ><a href="language/functions.html" title="Functions">Functions</a></li>
									<li ><a href="language/datatypes.html" title="Datatypes">Datatypes</a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->

	<header>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<div class="page-header">
 <h1>Bulk CSV Data Loading</h1>
</div> 
<p>Phoenix provides two methods for loading CSV data into Phoenix tables – a single-threaded client loading tool via the <a href="download.html#Loading-Data">psql</a> command, and a MapReduce-based bulk load tool. The psql tool is typically appropriate for tens of megabytes, while the MapReduce-based loader is typically better for larger load volumes.</p> 
<p>Use of both loaders is described below.</p> 
<div class="section"> 
 <h2 id="Sample_data">Sample data</h2> 
 <p>For the following examples, we will assume that we have a CSV file named “data.csv” with the following content:</p> 
 <div class="source"> 
  <pre>12345,John,Doe
67890,Mary,Poppins
</pre> 
 </div> 
 <p>We will use a table with the following structure:</p> 
 <div class="source"> 
  <pre> CREATE TABLE example (
    my_pk bigint not null,
    m.first_name varchar(50),
    m.last_name varchar(50) 
    CONSTRAINT pk PRIMARY KEY (my_pk))
</pre> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Loading_via_PSQL">Loading via PSQL</h2> 
 <p>The psql command is invoked via <tt>psql.py</tt> in the Phoenix bin directory. In order to use it to load CSV data, it is invoked by providing the connection information for your HBase cluster, the name of the table to load data into, and the path to the CSV file or files.</p> 
 <p>To load the example data outlined above into HBase running on the local machine, run the following command:</p> 
 <div class="source"> 
  <pre>bin/psql.py -t EXAMPLE localhost data.csv
</pre> 
 </div> 
 <p>The following parameters can be used for loading data with PSQL:</p> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="a"> 
    <th><i>Parameter</i> </th> 
    <th><i>Description</i> </th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td>-t </td> 
    <td>Provide the name of the table in which to load data. By default, the name of the table is taken from the name of the CSV file. </td> 
   </tr> 
   <tr class="a"> 
    <td>-h </td> 
    <td>Overrides the column names to which the CSV data maps and is case sensitive. A special value of in-line indicating that the first line of the CSV file determines the column to which the data maps. </td> 
   </tr> 
   <tr class="b"> 
    <td>-s </td> 
    <td>Run in strict mode, throwing an error on CSV parsing errors </td> 
   </tr> 
   <tr class="a"> 
    <td>-d </td> 
    <td>Supply a custom delimiter or delimiters for CSV parsing </td> 
   </tr> 
   <tr class="b"> 
    <td>-a </td> 
    <td>Supply an array delimiter (explained in more detail below) </td> 
   </tr> 
  </tbody> 
 </table> 
</div> 
<div class="section"> 
 <h2 id="Loading_via_MapReduce">Loading via MapReduce</h2> 
 <p>For higher-throughput loading distributed over the cluster, the MapReduce loader can be used. This loader first converts all data into HFiles, and then provides the created HFiles to HBase after the HFile creation is complete. </p> 
 <p>The MapReduce loader is launched using the <tt>hadoop</tt> command with the Phoenix client jar, as follows:</p> 
 <div class="source"> 
  <pre>hadoop jar phoenix-3.0.0-incubating-client.jar org.apache.phoenix.mapreduce.CsvBulkLoadTool --table EXAMPLE --input /data/example.csv
</pre> 
 </div> 
 <p>The input file must be present on HDFS (not the local filesystem where the command is being run). </p> 
 <p>The following parameters can be used with the MapReduce loader.</p> 
 <table border="0" class="bodyTable table table-striped table-hover"> 
  <thead> 
   <tr class="a"> 
    <th><i>Parameter</i> </th> 
    <th><i>Description</i> </th> 
   </tr> 
  </thead> 
  <tbody> 
   <tr class="b"> 
    <td>-i,–input </td> 
    <td>Input CSV path (mandatory) </td> 
   </tr> 
   <tr class="a"> 
    <td>-t,–table </td> 
    <td>Phoenix table name (mandatory) </td> 
   </tr> 
   <tr class="b"> 
    <td>-a,–array-delimiter </td> 
    <td>Array element delimiter (optional) </td> 
   </tr> 
   <tr class="a"> 
    <td>-c,–import-columns </td> 
    <td>Comma-separated list of columns to be imported </td> 
   </tr> 
   <tr class="b"> 
    <td>-d,–delimiter </td> 
    <td>Input delimiter, defaults to comma </td> 
   </tr> 
   <tr class="a"> 
    <td>-g,–ignore-errors </td> 
    <td>Ignore input errors </td> 
   </tr> 
   <tr class="b"> 
    <td>-o,–output </td> 
    <td>Output path for temporary HFiles (optional) </td> 
   </tr> 
   <tr class="a"> 
    <td>-s,–schema </td> 
    <td>Phoenix schema name (optional) </td> 
   </tr> 
   <tr class="b"> 
    <td>-z,–zookeeper </td> 
    <td>Zookeeper quorum to connect to (optional) </td> 
   </tr> 
  </tbody> 
 </table> 
 <div class="section"> 
  <h3 id="Notes_on_the_MapReduce_importer">Notes on the MapReduce importer</h3> 
  <ol style="list-style-type: decimal"> 
   <li>You must provide an explicit column family name in your CREATE TABLE statement for your non primary key columns, as the default column family used by Phoenix is treated specially by HBase because it starts with an underscore.</li> 
   <li>The current bulk loader does not support the migration of index related data yet. So, if you have created your phoenix table with index, please use the <a href="download.html#Loading-Data">psql CSV loader</a>.</li> 
  </ol> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Loading_array_data">Loading array data</h2> 
 <p>Both the PSQL loader and MapReduce loader support loading array values with the <tt>-a</tt> flag. Arrays in a CSV file are represented by a field that uses a different delimiter than the main CSV delimiter. For example, the following file would represent an id field and an array of integers:</p> 
 <div class="source"> 
  <pre>1,2:3:4
2,3:4,5
</pre> 
 </div> 
 <p>To load this file, the default delimiter (comma) would be used, and the array delimiter (colon) would be supplied with the parametr <tt>-a ':'</tt>.</p> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">About</li>
						<li >
							<a href="index.html" title="Overview">Overview</a>
						</li>
						<li >
							<a href="recent.html" title="New Features">New Features</a>
						</li>
						<li >
							<a href="roadmap.html" title="Roadmap">Roadmap</a>
						</li>
						<li >
							<a href="performance.html" title="Performance">Performance</a>
						</li>
						<li >
							<a href="team.html" title="Team">Team</a>
						</li>
						<li >
							<a href="mailing_list.html" title="Mailing Lists">Mailing Lists</a>
						</li>
						<li >
							<a href="source.html" title="Source Repository">Source Repository</a>
						</li>
						<li >
							<a href="issues.html" title="Issue Tracking">Issue Tracking</a>
						</li>
						<li >
							<a href="download.html" title="Download">Download</a>
						</li>
						<li >
							<a href="http://www.apache.org/licenses/" title="License" class="externalLink">License</a>
						</li>
						<li >
							<a href="http://www.apache.org/foundation/sponsorship.html" title="Sponsorship" class="externalLink">Sponsorship</a>
						</li>
						<li >
							<a href="http://www.apache.org/foundation/thanks.html" title="Thanks" class="externalLink">Thanks</a>
						</li>
						<li >
							<a href="http://www.apache.org/security/" title="Security" class="externalLink">Security</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Using</li>
						<li >
							<a href="faq.html" title="F.A.Q.">F.A.Q.</a>
						</li>
						<li >
							<a href="Phoenix-in-15-minutes-or-less.html" title="Quick Start">Quick Start</a>
						</li>
						<li >
							<a href="building.html" title="Building">Building</a>
						</li>
						<li >
							<a href="tuning.html" title="Tuning">Tuning</a>
						</li>
						<li >
							<a href="upgrade_from_2_2.html" title="Upgrade from 2.2">Upgrade from 2.2</a>
						</li>
						<li >
							<a href="secondary_indexing.html" title="Secondary Indexes">Secondary Indexes</a>
						</li>
						<li >
							<a href="joins.html" title="Joins">Joins</a>
						</li>
						<li >
							<a href="views.html" title="Views">Views</a>
						</li>
						<li >
							<a href="multi-tenancy.html" title="Multi tenancy">Multi tenancy</a>
						</li>
						<li >
							<a href="sequences.html" title="Sequences">Sequences</a>
						</li>
						<li >
							<a href="array_type.html" title="ARRAY type">ARRAY type</a>
						</li>
						<li >
							<a href="salted.html" title="Salted Tables">Salted Tables</a>
						</li>
						<li >
							<a href="paged.html" title="Paged Queries">Paged Queries</a>
						</li>
						<li >
							<a href="dynamic_columns.html" title="Dynamic Columns">Dynamic Columns</a>
						</li>
						<li >
							<a href="skip_scan.html" title="Skip Scan">Skip Scan</a>
						</li>
						<li class="active">
							<a href="#" title="Bulk Loading">Bulk Loading</a>
						</li>
						<li >
							<a href="phoenix_on_emr.html" title="Amazon EMR Support">Amazon EMR Support</a>
						</li>
						<li >
							<a href="flume.html" title="Apache Flume Plugin">Apache Flume Plugin</a>
						</li>
						<li >
							<a href="pig_integration.html" title="Apache Pig Integration">Apache Pig Integration</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Reference</li>
						<li >
							<a href="language/index.html" title="Grammar">Grammar</a>
						</li>
						<li >
							<a href="language/functions.html" title="Functions">Functions</a>
						</li>
						<li >
							<a href="language/datatypes.html" title="Datatypes">Datatypes</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-description">
					<form action="https://www.google.com/search" method="get"><input value="phoenix.incubator.apache.org" name="sitesearch" type="hidden"><input placeholder="Search the site&hellip;" required="required" style="width:170px;" size="18" name="q" id="query" type="search"></form>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2014 <a href="http://www.apache.org">Apache Software Foundation</a>. All Rights Reserved.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
	
	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
